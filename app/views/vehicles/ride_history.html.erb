<div class="container mx-auto px-4 py-8">
  <h1 class="text-3xl font-bold text-white mb-6">Ride History for <%= @vehicle.model.capitalize %></h1>

  <% if @bookings.any? %>
    <div class="space-y-6">
      <% @bookings.each do |booking| %>
        <div class="bg-gradient-to-br from-slate-800 via-slate-700 to-slate-900 text-gray-100 rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 border border-slate-600/40">
          <div class="p-6 space-y-3">
            <div class="flex flex-wrap gap-2 mb-2">
              <span class="inline-block bg-slate-600/40 px-3 py-1 rounded-full text-sm text-gray-200">
                <strong class="text-gray-100">From:</strong> <%= booking.start_location.humanize %>
              </span>
              <span class="inline-block bg-slate-600/40 px-3 py-1 rounded-full text-sm text-gray-200">
                <strong class="text-gray-100">To:</strong> <%= booking.end_location.humanize %>
              </span>
            </div>

            <p class="mb-1">
              <strong class="font-semibold text-gray-100">Customer:</strong>
              <span class="text-gray-300"><%= booking.user.name %></span>
            </p>
            <p class="mb-1">
              <strong class="font-semibold text-gray-100">Price:</strong>
              <span class="text-gray-300">₹<%= number_to_currency(booking.price || booking.proposed_price, unit: "", precision: 2) %></span>
            </p>
            <p class="mb-1">
              <strong class="font-semibold text-gray-100">Date:</strong>
              <span class="text-gray-300"><%= booking.booking_date.strftime('%d %b %Y, %I:%M %p') %></span>
            </p>

            <details class="mt-3 group">
              <summary class="cursor-pointer text-indigo-400 hover:text-indigo-300 font-medium transition-colors duration-200">
                View more details
              </summary>
              <div class="mt-3 bg-slate-800/50 rounded-xl p-3 text-sm text-gray-300 space-y-1 border border-slate-700/50">
                <p><strong>Start Time:</strong> <%= booking.start_time&.strftime('%d %b %Y, %I:%M %p') || 'N/A' %></p>
                <p><strong>End Time:</strong> <%= booking.end_time&.strftime('%d %b %Y, %I:%M %p') || 'N/A' %></p>

                <% if booking.end_time && booking.start_time %>
                  <% total_seconds = booking.end_time - booking.start_time %>
                  <% total_minutes = (total_seconds / 60).to_i %>
                  <% if total_minutes >= 60 %>
                    <% hours = total_minutes / 60 %>
                    <% minutes = total_minutes % 60 %>
                    <p><strong>Total Time:</strong> <%= "#{hours}h #{minutes}m" %></p>
                  <% else %>
                    <p><strong>Total Time:</strong> <%= "#{total_minutes} minutes" %></p>
                  <% end %>
                <% end %>

                <p><strong>Final Price:</strong> ₹<%= booking.price %></p>
                <p><strong>Status:</strong>
                  <% if booking.status %>
                    <span class="text-green-400 font-semibold">Confirmed</span>
                  <% else %>
                    <span class="text-yellow-400 font-semibold">Pending</span>
                  <% end %>
                </p>
                <p><strong>Ride Completed:</strong> <%= booking.ride_status ? "Yes" : "No" %></p>

                <% if booking.cancelled_by.present? %>
                  <p><strong>Cancelled By:</strong>
                    <span class="text-red-400"><%= booking.cancelled_by.titleize %></span>
                    on <%= booking.cancelled_at&.strftime('%d %b %Y, %I:%M %p') %>
                  </p>
                <% end %>
              </div>
            </details>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="text-center p-6 bg-gradient-to-br from-slate-800 via-slate-700 to-slate-900 rounded-2xl shadow-xl border border-slate-600/40">
      <p class="text-gray-300 text-lg">No completed rides for this vehicle.</p>
      <%= link_to "Go to Home", home_path,
          class: "inline-block bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2.5 px-6 rounded-full shadow-md transition-all duration-300 mt-4" %>
    </div>
  <% end %>
</div>
