<div class="max-w-7xl mx-auto px-4 py-6 mt-6">
  <h1 class="text-2xl font-bold text-white mb-6">Completed Rides</h1>

  <% if @bookings.blank? %>
    <div class="text-center p-8 bg-gradient-to-br from-gray-800 via-gray-900 to-black rounded-2xl shadow-lg border border-gray-700">
      <p class="text-gray-300 text-lg mb-4">You haven't completed a ride yet!</p>
      <div class="flex flex-col sm:flex-row justify-center gap-4">
        <%= link_to "Go to Ongoing Rides", driver_ongoing_path,
              class: "bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-6 rounded-lg shadow-md transition-all" %>
        <%= link_to "Go to Home", home_path,
              class: "bg-gray-700 hover:bg-gray-800 text-white font-semibold py-2.5 px-6 rounded-lg shadow-md transition-all" %>
      </div>
    </div>

  <% else %>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5">
      <% @bookings.each do |booking| %>
        <div class="bg-gradient-to-br from-gray-800 via-gray-800 to-gray-900 border border-gray-700 rounded-2xl shadow-lg overflow-hidden transform hover:scale-[1.02] hover:shadow-2xl transition-all duration-300 text-sm text-gray-200">

          <!-- Vehicle Image -->
          <div class="relative group">
            <% if booking.vehicle.image.attached? %>
              <div class="overflow-hidden relative">
                <%= image_tag booking.vehicle.image, class: "w-full h-44 object-cover transition-transform duration-500 group-hover:scale-105 border-b border-gray-700" %>
                <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-black/20 to-transparent opacity-70 group-hover:opacity-80 transition-opacity duration-300 rounded-t-2xl"></div>
              </div>
            <% else %>
              <div class="w-full h-44 bg-gray-700 flex items-center justify-center text-gray-400 text-sm border-b border-gray-700 rounded-t-2xl">
                ğŸš˜ No Image Available
              </div>
            <% end %>

            <div class="absolute inset-0 rounded-t-2xl ring-1 ring-blue-400/10 group-hover:ring-blue-400/40 group-hover:shadow-[0_0_25px_rgba(56,189,248,0.3)] transition-all duration-500"></div>
          </div>

          <!-- Card Content -->
          <div class="p-5 flex flex-col flex-1 space-y-2">

            <h2 class="text-lg font-semibold text-gray-100 mb-1"><%= booking.vehicle.model %></h2>
            <p><strong class="text-gray-300">ğŸ‘¤ Customer:</strong> <%= booking.user.name.capitalize %></p>
            <p><strong class="text-gray-300">ğŸ“… Date:</strong> <%= booking.start_time.strftime('%d %b %Y') %></p>
            <p><strong class="text-gray-300">ğŸ’° Final Price:</strong> â‚¹<%= booking.price %></p>

            <!-- Locations -->
            <div class="flex flex-wrap gap-2 mt-2">
              <span class="inline-block bg-gray-700/60 px-3 py-1 rounded-full text-gray-300 border border-gray-600 text-xs">
                ğŸš© <strong>From:</strong> <%= booking.start_location.humanize %>
              </span>
              <span class="inline-block bg-gray-700/60 px-3 py-1 rounded-full text-gray-300 border border-gray-600 text-xs">
                ğŸ <strong>To:</strong> <%= booking.end_location.humanize %>
              </span>
            </div>

            <!-- Details -->
            <details class="mt-3 bg-gray-800/60 border border-gray-700 rounded-lg p-3 text-gray-300">
              <summary class="text-blue-400 hover:text-blue-300 cursor-pointer font-medium">ğŸ“‹ View More Details</summary>
              <div class="mt-2 space-y-1 text-sm">
                <p><strong>Booking Date:</strong> <%= booking.booking_date&.strftime('%d %b %Y') || 'N/A' %></p>
                <p><strong>Start Time:</strong> <%= booking.start_time&.strftime('%I:%M %p') || 'N/A' %></p>
                <p><strong>End Time:</strong> <%= booking.end_time&.strftime('%I:%M %p') || 'N/A' %></p>

                <% if booking.end_time && booking.start_time %>
                  <% total_minutes = ((booking.end_time - booking.start_time) / 60).to_i %>
                  <% if total_minutes >= 60 %>
                    <% hours = total_minutes / 60 %>
                    <% minutes = total_minutes % 60 %>
                    <p><strong>Total Time:</strong> <%= "#{hours}h #{minutes}m" %></p>
                  <% else %>
                    <p><strong>Total Time:</strong> <%= "#{total_minutes} minutes" %></p>
                  <% end %>
                <% end %>
              </div>
            </details>

            <!-- Rating Section -->
            <% ride_rating = booking.ratings.first %>
            <div class="mt-3">
              <% if ride_rating %>
                <div class="bg-green-900/40 border border-green-500 rounded-lg px-3 py-2">
                  <p class="text-sm text-green-300">
                    â­ <strong>Rating:</strong> <%= ride_rating.stars %>/5 â€” <%= ride_rating.comments %>
                  </p>
                </div>
              <% else %>
                <p class="text-gray-500 italic text-sm mt-2">This ride has not been rated yet.</p>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Pagination -->
    <div class="mt-10 flex justify-center">
      <%= paginate @bookings %>
    </div>
  <% end %>
</div>
